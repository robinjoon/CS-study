# 세션 기반 인증 / 토큰 기반 인증

## 🔒 세션 기반 인증

서버 기반 인증 시스템이라고도하며 서버 측에서 사용자들의 정보를 기억하고 있어야 한다.<br/>
사용자들의 정보를 기억하기 위해서는 세션을 유지해야하며 메모리나 디스크 또는 데이터베이스 등을 통해 관리한다.<br/>
사용자의 정보는 클라이언트의 요청을 받고 유지한다. 여기서 단점은 

1. **사용자가 늘어날 경우 서버의 RAM에 부하가 걸리게 되어** db에 저장하는 경우도 있지만 역시 db에 무리를 줄 수 있다.<br/>

 2. 많은 트래픽을 처리하기 위해 여러 프로세스를 돌리거나 컴퓨터를 추가하는 등 서버를 확장해야 한다. 세션을 사용한다면 세션을 분산시키는 시스템을 설계 해야 하지만 매우 어렵고 복잡하다.

 3. CORS - 웹 어플리케이션에서 세션을 관리할 때 자주 사용되는 **쿠키는 단일 도메인 및 서브 도메인에서만 작동**하도록 설계되어 있다. 따라서 쿠키를 여러 도메인에서 관리하는것은 어렵다.

<br/>

## 🔒 토큰 기반 인증

토큰 기반 인증 시스템은 인증받은 사용들에게 토큰을 발급하고, **서버에 요청을 할때에 헤더에 토큰을 함께 보내도록** 하여 유효성 검사를 한다. 서버 기반의 인증 시스템과 달리 상태를 유지하지 않으므로 Stateless한 구조를 갖는다. 이러한 경우 사용자가 로그인이 되어있는지 안되어있는지 신경쓰지 않고 손쉽게 시스템을 확장할 수 있다.

### 작동 방법
    1. 사용자가 아이디와 비밀번호로 로그인을 한다.
    2. 서버 측에서 해당 정보를 검증한다.
    3. 정보가 정확하다면 서버 측에서 사용자에게 Signed 토큰을 발급한다. (Signed는 해당 토큰이 서버에서 정상적으로 발급된 토큰임을 증명하는 Signature를 가지고 있다는 것)
    4. 클라이언트 측에서 전달받은 토큰을 저장해두고, 서버에 요청을 할 때마다 해당 토큰을 서버에 함께 전달한다. 이때 Http 요청 헤더에 토큰을 포함시킨다.
    5. 서버는 토큰을 검증하고, 요청에 응답한다.

##  🥸 어느 경우에 적합한가
 - `단일` 도메인 -> 세션 기반 인증
 - `여러` 도메인 -> 토큰 기반 인증 <br/>
  👉🏻 세션을 관리할 때 사용하는 쿠키는 CORS 문제로 단일 도메인 및 서브 도메인에서만 작동하도록 설계되어 있기 때문에 여러 도메인에서 관리하는 것이 어렵다.
